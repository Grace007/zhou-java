package com.zhou.util.pdf;

import com.lowagie.text.DocumentException;
import com.lowagie.text.pdf.BaseFont;
import freemarker.core.ParseException;
import freemarker.template.*;
import org.xhtmlrenderer.pdf.ITextRenderer;

import java.io.File;
import java.io.IOException;
import java.io.StringWriter;
import java.util.Locale;

public class PdfHelper {
	public static ITextRenderer getRender() throws DocumentException, IOException {

		ITextRenderer render = new ITextRenderer();

		String pa="\n" +
				"<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" baseProfile=\"full\" width=\"485\" height=\"300\" style=\"user-select: none; position: absolute; left: 0px; top: 0px;\"><path d=\"M 36.6242 271.5 L 266.75 271.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 241.5 L 266.75 241.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 210.5 L 266.75 210.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 180.5 L 266.75 180.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 150.5 L 266.75 150.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 120.5 L 266.75 120.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 90.5 L 266.75 90.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 60.5 L 266.75 60.5\" fill=\"none\" stroke=\"#ccc\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.5 271 L 36.5 60\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"round\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><text alignment-baseline=\"baseline\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,36.62421798706055,45)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"baseline\" text-anchor=\"middle\" x=\"0\" y=\"0\">Unit (billion)</tspan></text><path d=\"M 36.6242 271.5 L 266.75 271.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"round\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 271.5 L 31.6242 271.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 241.5 L 31.6242 241.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 210.5 L 31.6242 210.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 180.5 L 31.6242 180.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 150.5 L 31.6242 150.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 120.5 L 31.6242 120.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 90.5 L 31.6242 90.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.6242 60.5 L 31.6242 60.5\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 36.5 271 L 36.5 276\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 151.5 271 L 151.5 276\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><path d=\"M 266.5 271 L 266.5 276\" fill=\"none\" stroke=\"#333\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,271)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">0</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,240.85714721679688)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">10</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,210.71429443359375)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">20</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,180.57142639160156)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">30</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,150.42857360839844)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">40</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,120.28572082519531)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">50</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,90.14285278320312)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">60</tspan></text><text alignment-baseline=\"middle\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,2.4492937051703357e-16,-2.4492937051703357e-16,1,28.624217987060547,60)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"0\" y=\"0\">70</tspan></text><text alignment-baseline=\"hanging\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,94.1556625366211,279)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"hanging\" text-anchor=\"middle\" x=\"0\" y=\"0\">2015</tspan></text><text alignment-baseline=\"hanging\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,209.2185516357422,279)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"hanging\" text-anchor=\"middle\" x=\"0\" y=\"0\">2016</tspan></text><path d=\"M 48.1305 271 L 140.18079999999998 271 L 140.18079999999998 128.7257 L 48.1305 128.7257 L 48.1305 271 Z\" fill=\"#c23531\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"135.18082031249997\" y=\"199.86285714285714\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#c23531\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,135.18082031249997,199.86285714285714)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"135.18082031249997\" y=\"199.86285714285714\">47.2</tspan></text><path d=\"M 163.1934 271 L 255.2437 271 L 255.2437 121.7929 L 163.1934 121.7929 L 163.1934 271 Z\" fill=\"#c23531\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"250.24371093749997\" y=\"196.39642857142857\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#c23531\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,250.24371093749997,196.39642857142857)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"250.24371093749997\" y=\"196.39642857142857\">49.5</tspan></text><path d=\"M 48.1305 128.7257 L 140.18079999999998 128.7257 L 140.18079999999998 116.3671 L 48.1305 116.3671 L 48.1305 128.7257 Z\" fill=\"#2f4554\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"135.18082031249997\" y=\"122.54642857142858\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#2f4554\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,135.18082031249997,122.54642857142858)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"135.18082031249997\" y=\"122.54642857142858\">4.1</tspan></text><path d=\"M 163.1934 121.7929 L 255.2437 121.7929 L 255.2437 109.43430000000001 L 163.1934 109.43430000000001 L 163.1934 121.7929 Z\" fill=\"#2f4554\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"250.24371093749997\" y=\"115.61357142857145\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#2f4554\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,250.24371093749997,115.61357142857145)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"250.24371093749997\" y=\"115.61357142857145\">4.1</tspan></text><path d=\"M 48.1305 116.3671 L 140.18079999999998 116.3671 L 140.18079999999998 113.05139999999999 L 48.1305 113.05139999999999 L 48.1305 116.3671 Z\" fill=\"#61a0a8\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"135.18082031249997\" y=\"114.70928571428573\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#61a0a8\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,135.18082031249997,114.70928571428573)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"135.18082031249997\" y=\"114.70928571428573\">1.1</tspan></text><path d=\"M 163.1934 109.4343 L 255.2437 109.4343 L 255.2437 107.9272 L 163.1934 107.9272 L 163.1934 109.4343 Z\" fill=\"#61a0a8\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"250.24371093749997\" y=\"108.68071428571432\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#61a0a8\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,250.24371093749997,108.68071428571432)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"250.24371093749997\" y=\"108.68071428571432\">0.5</tspan></text><path d=\"M 48.1305 113.0514 L 140.18079999999998 113.0514 L 140.18079999999998 108.53 L 48.1305 108.53 L 48.1305 113.0514 Z\" fill=\"#d48265\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"135.18082031249997\" y=\"110.79071428571427\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#d48265\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,135.18082031249997,110.79071428571427)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"135.18082031249997\" y=\"110.79071428571427\">1.5</tspan></text><path d=\"M 163.1934 107.9271 L 255.2437 107.9271 L 255.2437 107.8367 L 163.1934 107.8367 L 163.1934 107.9271 Z\" fill=\"#d48265\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"250.24371093749997\" y=\"107.8819285714286\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#d48265\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,250.24371093749997,107.8819285714286)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"250.24371093749997\" y=\"107.8819285714286\">0.03</tspan></text><path d=\"M 48.1305 108.53 L 140.18079999999998 108.53 L 140.18079999999998 89.2386 L 48.1305 89.2386 L 48.1305 108.53 Z\" fill=\"#91c7ae\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"135.18082031249997\" y=\"98.88428571428568\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#91c7ae\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,135.18082031249997,98.88428571428568)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"135.18082031249997\" y=\"98.88428571428568\">6.4</tspan></text><path d=\"M 163.1934 107.8367 L 255.2437 107.8367 L 255.2437 91.25809999999998 L 163.1934 91.25809999999998 L 163.1934 107.8367 Z\" fill=\"#91c7ae\" fill-opacity=\"undefined\" stroke=\"none\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"250.24371093749997\" y=\"99.54742857142861\" fill=\"#fff\" fill-opacity=\"undefined\" stroke=\"#91c7ae\" stroke-width=\"2\" paint-order=\"stroke\" stroke-opacity=\"undefined\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"rotate(NaN,250.24371093749997,99.54742857142861)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"250.24371093749997\" y=\"99.54742857142861\">5.5</tspan></text><path d=\"M -5 -5 L 241.7246 -5 L 241.7246 115 L -5 115 L -5 -5 Z\" fill=\"rgba(0,0,0,0)\" fill-opacity=\"1\" stroke=\"#ccc\" stroke-width=\"0\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"matrix(1,0,0,1,243.275390625,95)\" clip-path=\"none\"></path><path d=\"M 3.5 0 L 21.5 0 A 3.5 3.5 0 0 1 25 3.5 L 25 10.5 A 3.5 3.5 0 0 1 21.5 14 L 3.5 14 A 3.5 3.5 0 0 1 0 10.5 L 0 3.5 A 3.5 3.5 0 0 1 3.5 0 Z\" fill=\"#c23531\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,95)\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"-5\" y=\"7\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,95)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"-5\" y=\"7\">Liquid milk &amp; Yogurt/4.9%</tspan></text><path d=\"M 3.5 0 L 21.5 0 A 3.5 3.5 0 0 1 25 3.5 L 25 10.5 A 3.5 3.5 0 0 1 21.5 14 L 3.5 14 A 3.5 3.5 0 0 1 0 10.5 L 0 3.5 A 3.5 3.5 0 0 1 3.5 0 Z\" fill=\"#2f4554\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,119)\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"-5\" y=\"7\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,119)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"-5\" y=\"7\">Ice cream/0.0%</tspan></text><path d=\"M 3.5 0 L 21.5 0 A 3.5 3.5 0 0 1 25 3.5 L 25 10.5 A 3.5 3.5 0 0 1 21.5 14 L 3.5 14 A 3.5 3.5 0 0 1 0 10.5 L 0 3.5 A 3.5 3.5 0 0 1 3.5 0 Z\" fill=\"#61a0a8\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,143)\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"-5\" y=\"7\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,143)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"-5\" y=\"7\">Mixed feeds/-54.5%</tspan></text><path d=\"M 3.5 0 L 21.5 0 A 3.5 3.5 0 0 1 25 3.5 L 25 10.5 A 3.5 3.5 0 0 1 21.5 14 L 3.5 14 A 3.5 3.5 0 0 1 0 10.5 L 0 3.5 A 3.5 3.5 0 0 1 3.5 0 Z\" fill=\"#d48265\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,167)\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"-5\" y=\"7\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,167)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"-5\" y=\"7\">others/-98.0%</tspan></text><path d=\"M 3.5 0 L 21.5 0 A 3.5 3.5 0 0 1 25 3.5 L 25 10.5 A 3.5 3.5 0 0 1 21.5 14 L 3.5 14 A 3.5 3.5 0 0 1 0 10.5 L 0 3.5 A 3.5 3.5 0 0 1 3.5 0 Z\" fill=\"#91c7ae\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,191)\" clip-path=\"none\"></path><text alignment-baseline=\"middle\" x=\"-5\" y=\"7\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,455,191)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"middle\" text-anchor=\"end\" x=\"-5\" y=\"7\">Milk powder &amp; dairy related/-14.1%</tspan></text><path d=\"M -13.9784 -15 L 36.9785 -15 L 36.9785 15 L -13.9784 15 L -13.9784 -15 Z\" fill=\"rgba(0, 0, 0, 0.002)\" fill-opacity=\"1\" stroke=\"#ccc\" stroke-width=\"0\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"matrix(1,0,0,1,448.02154541015625,15)\" clip-path=\"none\"></path><path d=\"M -6.4526 -1.5776 L -0.0905 4.2672 L 6.4784 -1.4483 M -6.4784 3.7759 L -6.4784 7.5 L 6.2457 7.5 L 6.2457 3.7759 M -0.1164 4.1638 L -0.1164 -7.5\" fill=\"none\" stroke=\"#666\" stroke-width=\"1\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"matrix(1,0,0,1,448.02154541015625,15)\" clip-path=\"none\"></path><image xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"http://pic.sfont.cn/svg/img/f7h22j.svg\" width=\"15\" height=\"15\" x=\"-7.5\" y=\"-7.5\" transform=\"matrix(1,0,0,1,472.5,15)\" clip-path=\"none\"></image><path d=\"M -102 -5 L 102 -5 L 102 17 L -102 17 L -102 -5 Z\" fill=\"rgba(0,0,0,0)\" fill-opacity=\"1\" stroke=\"#ccc\" stroke-width=\"0\" paint-order=\"fill\" stroke-opacity=\"1\" stroke-dasharray=\"\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" transform=\"matrix(1,0,0,1,242.5,5)\" clip-path=\"none\"></path><text alignment-baseline=\"hanging\" x=\"0\" y=\"0\" fill=\"#333\" fill-opacity=\"1\" stroke=\"none\" transform=\"matrix(1,0,0,1,242.5,5)\" clip-path=\"none\" style=\"font-style: normal; font-variant: normal; font-weight: bolder; font-stretch: normal; font-size: 10px; line-height: normal; font-family: &quot;Microsoft YaHei&quot;;\"><tspan alignment-baseline=\"hanging\" text-anchor=\"middle\" x=\"0\" y=\"0\">Sales Value By Product Segment</tspan></text></svg>\n";
		String path = getPath();
		// 添加字体，以支持中文
		render.getFontResolver().addFont(path + "arialuni.ttf", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);
		render.getFontResolver().addFont(path + "simsun.ttc", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);

		return render;
	}

	// 获取要写入PDF的内容
	public static String getPdfContent(String ftlPath, String ftlName, Object o) throws TemplateNotFoundException,
			MalformedTemplateNameException, ParseException, IOException, TemplateException {
		return useTemplate(ftlPath, ftlName, o);
	}

	// 使用freemarker得到html内容
	public static String useTemplate(String ftlPath, String ftlName, Object o) throws TemplateNotFoundException,
			MalformedTemplateNameException, ParseException, IOException, TemplateException {

		String html = null;

		Template tpl = getFreemarkerConfig(ftlPath).getTemplate(ftlName);
		tpl.setEncoding("UTF-8");

		StringWriter writer = new StringWriter();
		tpl.process(o, writer);
		writer.flush();
		html = writer.toString();
		return html;
	}

	/**
	 * 获取Freemarker配置
	 * 
	 * @param templatePath
	 * @return
	 * @throws IOException
	 */
	private static Configuration getFreemarkerConfig(String templatePath) throws IOException {
		freemarker.template.Version version = new freemarker.template.Version("2.3.22");
		Configuration config = new Configuration(version);
		// new File(templatePath)
		// "classpath:"+templatePath
		// File file = ResourceUtils.getFile("classpath:"+templatePath);

		// ResourcePatternResolver resolver = new
		// PathMatchingResourcePatternResolver();
		// Resource r = resolver.getResource(templatePath);
		// InputStream stream = r.getInputStream();
		// String targetFilePath = r.getFilename();

		// System.out.println("放置位置 [" + targetFilePath + "]");

		// File ttfFile = new File("D://"+targetFilePath);
		// FileUtils.copyInputStreamToFile(stream, ttfFile);
		// URL u = PdfHelper.class.getResource(templatePath);
		// System.out.println(u.getPath());

		// File ff = ResourceUtils.getFile(u);
		// System.out.println(ff.getAbsolutePath());
		config.setDirectoryForTemplateLoading(new File(templatePath));
		config.setEncoding(Locale.CHINA, "utf-8");
		return config;
	}

	/**
	 * 获取类路径
	 * 
	 * @return
	 */
	public static String getPath() {
		return PdfHelper.class.getResource("/").getPath().substring(1);
	}
}
